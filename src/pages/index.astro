---
import AppLayout from "@layouts/AppLayout.astro";
import Layout from "@layouts/Layout.astro";
import { firestore } from "@lib/firebase/server";
import { getUser } from "@lib/utils";

/* Get session cookie */
const sessionCookie = Astro.cookies.get("session")
  ? Astro.cookies.get("session")!.value
  : null;
if (!sessionCookie) {
  return Astro.redirect("/signin");
}

/* Verify session cookie and get user */
const user = await getUser(sessionCookie);
if (!user) {
  return Astro.redirect("/signin");
}

// /* get birthdates from firestore */
// const querySnashot = await firestore
// .collection("blogs")
// .where("authorId", "==", user.uid)
// .get();
// console.log(Editor);
/* compute difference in days and sort */
---

<Layout title="Dashboard">
  <!-- <Editor client:only /> -->
  <AppLayout>
    <main class="w-full grow flex flex-col items-center px-4">
      <h1
        class="text-xl sm:text-3xl max-w-xl dark:text-zinc-100 w-full text-zinc-900 font-semibold mt-10 mb-6"
      >
        CKEditor 5
      </h1>
      <div id="editor" style="height: 500px;"></div>
    </main>
  </AppLayout>
</Layout>
<script>
  import ClassicEditor from "axotolt-markdown-editor";

  function ready() {
    ClassicEditor.create(document.querySelector("#editor") as HTMLElement, {});
  }
  document.addEventListener("DOMContentLoaded", ready);
</script>
